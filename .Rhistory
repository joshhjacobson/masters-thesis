model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(c(fields$variable1, ensemble))
}
build_ensemble <- function(n=11, xi, x, y, plot=TRUE) {
# n: number of ensemble members
# xi: controls standard variance of model
# x, y: field dimensions
# plot: display or not?
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(c(fields$variable1, ensemble))
}
build_ensemble(xi, x, y)
build_ensemble(xi=xi, x=x, y=y)
return(c(fields, ensemble))
build_ensemble <- function(n=11, xi, x, y, plot=TRUE) {
# n: number of ensemble members
# xi: controls standard variance of model
# x, y: field dimensions
# plot: display or not?
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(c(fields, ensemble))
}
build_ensemble <- function(xi, x, y, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(c(fields, ensemble))
}
build_ensemble(xi,x,y)
build_ensemble <- function(xi, x, y, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(fields, ensemble)
}
build_ensemble(xi,x,y)
build_ensemble <- function(xi, x, y, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(c(fields$variable1, ensemble))
}
?is.null
is.null(x)
is.null()
test <- build_ensemble(xi, plot=FALSE)
test <- build_ensemble(xi, plot=FALSE)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
print("here")
x <- y <- seq(-20, 20, 0.2)
}
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(c(fields$variable1, ensemble))
}
test <- build_ensemble(xi, plot=FALSE)
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
test <- build_ensemble(xi, plot=FALSE)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(c(fields$variable1, ensemble))
}
test <- build_ensemble(xi, plot=FALSE)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
# omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
#
# # model
# model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
# fields <- RFsimulate(model_biwm, x, y)
#
# zbar <- fields$variable2
# zbar <- replicate(n, zbar)
# ensemble <- xi*zbar + sqrt(1-xi^2)*omega
#
# if(plot){
#   quartz()
#   for (index in 1:ncol(ensemble)) {
#     fields$variable2 <- ensemble[,index]
#     plot(fields)
#   }
# }
#
# return(c(fields$variable1, ensemble))
}
test <- build_ensemble(xi, plot=FALSE)
rm(model_whittle)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
#ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# # model
# model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
# fields <- RFsimulate(model_biwm, x, y)
#
# zbar <- fields$variable2
# zbar <- replicate(n, zbar)
# ensemble <- xi*zbar + sqrt(1-xi^2)*omega
#
# if(plot){
#   quartz()
#   for (index in 1:ncol(ensemble)) {
#     fields$variable2 <- ensemble[,index]
#     plot(fields)
#   }
# }
#
# return(c(fields$variable1, ensemble))
}
rm(model_whittle)
test <- build_ensemble(xi, plot=FALSE)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
# ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
# zbar <- fields$variable2
# zbar <- replicate(n, zbar)
# ensemble <- xi*zbar + sqrt(1-xi^2)*omega
#
# if(plot){
#   quartz()
#   for (index in 1:ncol(ensemble)) {
#     fields$variable2 <- ensemble[,index]
#     plot(fields)
#   }
# }
#
# return(c(fields$variable1, ensemble))
}
test <- build_ensemble(xi, plot=FALSE)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
# ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
#fields <- RFsimulate(model_biwm, x, y)
# zbar <- fields$variable2
# zbar <- replicate(n, zbar)
# ensemble <- xi*zbar + sqrt(1-xi^2)*omega
#
# if(plot){
#   quartz()
#   for (index in 1:ncol(ensemble)) {
#     fields$variable2 <- ensemble[,index]
#     plot(fields)
#   }
# }
#
# return(c(fields$variable1, ensemble))
}
test <- build_ensemble(xi, plot=FALSE)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
# ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
# zbar <- fields$variable2
# zbar <- replicate(n, zbar)
# ensemble <- xi*zbar + sqrt(1-xi^2)*omega
#
# if(plot){
#   quartz()
#   for (index in 1:ncol(ensemble)) {
#     fields$variable2 <- ensemble[,index]
#     plot(fields)
#   }
# }
#
# return(c(fields$variable1, ensemble))
}
test <- build_ensemble(xi, plot=FALSE)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
smooth <- c(1.5, 1.5, 1.5)
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
# ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(c(fields$variable1, ensemble))
}
test <- build_ensemble(xi, plot=FALSE)
test <- build_ensemble(xi=xi, plot=FALSE)
xi <- 0.8
test <- build_ensemble(xi, plot=FALSE)
?matrix
data.frame
?data.frame
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
smooth <- c(1.5, 1.5, 1.5)
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
# ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(data.frame(fields$variable1, ensemble))
}
test <- build_ensemble(xi, plot=FALSE)
View(test)
build_ensemble <- function(xi, x=NULL, y=NULL, n=11, plot=TRUE) {
# xi: controls standard variance of model
# x, y: field dimensions
# n: number of ensemble members
# plot: display or not?
if (is.null(x) | is.null(y)) {
x <- y <- seq(-20, 20, 0.2)
}
# parameters
smooth <- c(1.5, 1.5, 1.5)
scale <- c(0.5, 0.5, 0.5)
corr <- c(1, 1)
rho <- 0.8
# ensemble
model_whittle <- RMwhittle(nu = 1.5, notinvnu = TRUE, scale = 0.5, var = 1)
omega <- replicate(n, RFsimulate(model_whittle, x, y)$variable1)
# model
model_biwm <- RMbiwm(nu = smooth, s = scale, cdiag = corr, rhored = rho)
fields <- RFsimulate(model_biwm, x, y)
zbar <- fields$variable2
zbar <- replicate(n, zbar)
ensemble <- xi*zbar + sqrt(1-xi^2)*omega
if(plot){
quartz()
for (index in 1:ncol(ensemble)) {
fields$variable2 <- ensemble[,index]
plot(fields)
}
}
return(data.frame(fields$variable1, ensemble))
}
?seq
xi <- seq(0.5,0.9,0.05)
for (ii in xi) {
quartz()
build_ensemble(xi=ii)
}
for (ii in xi) {
#quartz()
build_ensemble(xi=ii)
}
length(xi)
